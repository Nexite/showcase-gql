# Migration `20201023152017-composite-primary-keys`

This migration has been generated by Tyler Menezes at 10/23/2020, 11:20:17 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `Member` DROP PRIMARY KEY,
    DROP COLUMN `id`,
    ADD PRIMARY KEY (`projectId`, `username`)

ALTER TABLE `Metadata` DROP PRIMARY KEY,
    DROP COLUMN `id`,
    ADD PRIMARY KEY (`projectId`, `key`)

CREATE UNIQUE INDEX `Award.projectId_type_modifier_unique` ON `Award`(`projectId`, `type`, `modifier`)
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201023134112-media-optional-fields..20201023152017-composite-primary-keys
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -60,9 +60,9 @@
   topic       MediaTopic
   image       String
   stream      String?
-  download    String
+  download    String?
   project     Project     @relation(fields: [projectId], references: [id])
   projectId   String
 }
@@ -76,23 +76,27 @@
   modifier    String?
   project     Project     @relation(fields: [projectId], references: [id])
   projectId   String
+
+  @@unique([projectId, type, modifier])
 }
 model Member {
-  id          String      @id @default(cuid())
+  @@id([projectId, username])
+
   createdAt         DateTime  @default(now())
   updatedAt         DateTime  @updatedAt
+
   username    String
   project     Project     @relation(fields: [projectId], references: [id])
   projectId   String
 }
 model Metadata {
-  id          String      @id @default(cuid())
+  @@id([projectId, key])
   createdAt         DateTime  @default(now())
   updatedAt         DateTime  @updatedAt
   key         String
```


