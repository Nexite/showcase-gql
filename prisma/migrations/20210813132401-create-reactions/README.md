# Migration `20210813132401-create-reactions`

This migration has been generated by Tyler Menezes at 8/13/2021, 9:24:01 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `Media` MODIFY `type` ENUM('VIDEO', 'AUDIO', 'IMAGE') NOT NULL

CREATE TABLE `ReactionCount` (
    `type` ENUM('CLAP', 'HEART', 'UPVOTE', 'GRIN') NOT NULL,
    `count` INT NOT NULL DEFAULT 0,
    `projectId` VARCHAR(191) NOT NULL,

    PRIMARY KEY (`type`,`projectId`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `ReactionCount` ADD FOREIGN KEY (`projectId`) REFERENCES `Project`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210518180713-add-audio-type..20210813132401-create-reactions
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -36,8 +36,15 @@
   PRIVATE
   ADMIN
 }
+enum ReactionType {
+  CLAP
+  HEART
+  UPVOTE
+  GRIN
+}
+
 model Project {
   id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
@@ -60,8 +67,9 @@
   members      Member[]
   metadata     Metadata[]
   metrics      Metric[]
   judgements   Judgement[]
+  reactionCounts    ReactionCount[]
 }
 model Media {
   id        String   @id @default(cuid())
@@ -183,4 +191,14 @@
   value    Float
   @@unique([projectId, judgingCriteriaId, username])
 }
+
+model ReactionCount {
+  type ReactionType
+  count Int @default(0)
+
+  project   Project @relation(fields: [projectId], references: [id])
+  projectId String
+
+  @@id([type, projectId])
+}
```


